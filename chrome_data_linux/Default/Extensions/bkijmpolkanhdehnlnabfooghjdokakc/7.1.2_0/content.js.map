{"version":3,"sources":["browser-polyfill.js","../node_modules/webextension-polyfill-ts/lib/index.js","../src/index.ts","../src/utils.ts","../src/comparator.ts","common/filtering.ts","common/settings/validation.ts","common/settings/enums.ts","common/settings/io.ts","common/settings/settings.ts","common/settings/monitoring.ts","content/cursor-tracking.ts","../lib/functions.ts","../lib/index.ts","content/dom.ts","common/messages.ts","content/downloads.ts","content/filtering/state.ts","content/filtering/index.ts","content/doubleclick.ts","common/triggerable.ts","content/hoverbutton/skinning.ts","content/hoverbutton/element.ts","content/drag.ts","content/hoverbutton/area.ts","content/hoverbutton/offset.ts","content/hoverbutton/layout.ts","content/hover-tracking.ts","content/hoverbutton/hoverbutton.ts","content/hotkey.ts","content/selection.ts","content/messaging.ts","content.ts"],"names":["browser","Object","getPrototypeOf","prototype","CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE","SEND_RESPONSE_DEPRECATION_WARNING","wrapAPIs","extensionAPIs","apiMetadata","keys","length","Error","DefaultWeakMap","WeakMap","constructor","createItem","items","get","key","has","set","isThenable","makeCallback","promise","metadata","callbackArgs","runtime","lastError","reject","message","singleCallbackArg","resolve","pluralizeArguments","numArgs","wrapMethod","target","method","wrapper","Proxy","apply","targetMethod","thisObj","args","call","hasOwnProperty","Function","bind","wrapObject","wrappers","cache","create","handlers","proxyTarget","prop","receiver","undefined","value","name","minArgs","maxArgs","Promise","fallbackToNoCallback","cbError","console","warn","noCallback","wrapAsyncFunction","defineProperty","configurable","enumerable","desc","Reflect","deleteProperty","wrapEvent","wrapperMap","addListener","listener","hasListener","removeListener","onRequestFinishedWrappers","req","wrappedReq","getContent","loggedSendResponseDeprecationWarning","onMessageWrappers","sender","sendResponse","didCallSendResponse","wrappedSendResponse","result","sendResponsePromise","response","stack","err","isResultThenable","then","sendPromisedResult","msg","error","__mozWebExtensionPolyfillReject__","catch","wrappedSendMessage","apiNamespaceObj","wrappedCb","reply","push","sendMessage","staticWrappers","devtools","network","onRequestFinished","onMessage","onMessageExternal","tabs","settingMetadata","clear","privacy","services","websites","chrome","id","module","exports"],"mappings":"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","file":"content.js","sourceRoot":"..\\src","sourcesContent":["/* webextension-polyfill - v0.8.0 - Tue Apr 20 2021 11:27:38 */\n/* -*- Mode: indent-tabs-mode: nil; js-indent-level: 2 -*- */\n/* vim: set sts=2 sw=2 et tw=80: */\n/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\"use strict\";\n\nif (typeof browser === \"undefined\" || Object.getPrototypeOf(browser) !== Object.prototype) {\n  const CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE = \"The message port closed before a response was received.\";\n  const SEND_RESPONSE_DEPRECATION_WARNING = \"Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)\";\n\n  // Wrapping the bulk of this polyfill in a one-time-use function is a minor\n  // optimization for Firefox. Since Spidermonkey does not fully parse the\n  // contents of a function until the first time it's called, and since it will\n  // never actually need to be called, this allows the polyfill to be included\n  // in Firefox nearly for free.\n  const wrapAPIs = extensionAPIs => {\n    // NOTE: apiMetadata is associated to the content of the api-metadata.json file\n    // at build time by replacing the following \"include\" with the content of the\n    // JSON file.\n    const apiMetadata = {\n      \"alarms\": {\n        \"clear\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"clearAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"get\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"bookmarks\": {\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getChildren\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getRecent\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getSubTree\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTree\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"move\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeTree\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"browserAction\": {\n        \"disable\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"enable\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"getBadgeBackgroundColor\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getBadgeText\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"openPopup\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"setBadgeBackgroundColor\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setBadgeText\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"setPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"browsingData\": {\n        \"remove\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"removeCache\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeCookies\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeDownloads\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeFormData\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeHistory\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeLocalStorage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removePasswords\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removePluginData\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"settings\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"commands\": {\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"contextMenus\": {\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"cookies\": {\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAllCookieStores\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"set\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"devtools\": {\n        \"inspectedWindow\": {\n          \"eval\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2,\n            \"singleCallbackArg\": false\n          }\n        },\n        \"panels\": {\n          \"create\": {\n            \"minArgs\": 3,\n            \"maxArgs\": 3,\n            \"singleCallbackArg\": true\n          },\n          \"elements\": {\n            \"createSidebarPane\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            }\n          }\n        }\n      },\n      \"downloads\": {\n        \"cancel\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"download\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"erase\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getFileIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"open\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"pause\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeFile\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"resume\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"show\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"extension\": {\n        \"isAllowedFileSchemeAccess\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"isAllowedIncognitoAccess\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"history\": {\n        \"addUrl\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"deleteAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"deleteRange\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"deleteUrl\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getVisits\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"i18n\": {\n        \"detectLanguage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAcceptLanguages\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"identity\": {\n        \"launchWebAuthFlow\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"idle\": {\n        \"queryState\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"management\": {\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getSelf\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"setEnabled\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"uninstallSelf\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        }\n      },\n      \"notifications\": {\n        \"clear\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getPermissionLevel\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"pageAction\": {\n        \"getPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"hide\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"setPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"show\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"permissions\": {\n        \"contains\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"request\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"runtime\": {\n        \"getBackgroundPage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getPlatformInfo\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"openOptionsPage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"requestUpdateCheck\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"sendMessage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 3\n        },\n        \"sendNativeMessage\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"setUninstallURL\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"sessions\": {\n        \"getDevices\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getRecentlyClosed\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"restore\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        }\n      },\n      \"storage\": {\n        \"local\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"managed\": {\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          }\n        },\n        \"sync\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        }\n      },\n      \"tabs\": {\n        \"captureVisibleTab\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 2\n        },\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"detectLanguage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"discard\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"duplicate\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"executeScript\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getCurrent\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getZoom\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getZoomSettings\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"goBack\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"goForward\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"highlight\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"insertCSS\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"move\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"query\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"reload\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 2\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeCSS\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"sendMessage\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 3\n        },\n        \"setZoom\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"setZoomSettings\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"update\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        }\n      },\n      \"topSites\": {\n        \"get\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"webNavigation\": {\n        \"getAllFrames\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getFrame\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"webRequest\": {\n        \"handlerBehaviorChanged\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"windows\": {\n        \"create\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getCurrent\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getLastFocused\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      }\n    };\n\n    if (Object.keys(apiMetadata).length === 0) {\n      throw new Error(\"api-metadata.json has not been included in browser-polyfill\");\n    }\n\n    /**\n     * A WeakMap subclass which creates and stores a value for any key which does\n     * not exist when accessed, but behaves exactly as an ordinary WeakMap\n     * otherwise.\n     *\n     * @param {function} createItem\n     *        A function which will be called in order to create the value for any\n     *        key which does not exist, the first time it is accessed. The\n     *        function receives, as its only argument, the key being created.\n     */\n    class DefaultWeakMap extends WeakMap {\n      constructor(createItem, items = undefined) {\n        super(items);\n        this.createItem = createItem;\n      }\n\n      get(key) {\n        if (!this.has(key)) {\n          this.set(key, this.createItem(key));\n        }\n\n        return super.get(key);\n      }\n    }\n\n    /**\n     * Returns true if the given object is an object with a `then` method, and can\n     * therefore be assumed to behave as a Promise.\n     *\n     * @param {*} value The value to test.\n     * @returns {boolean} True if the value is thenable.\n     */\n    const isThenable = value => {\n      return value && typeof value === \"object\" && typeof value.then === \"function\";\n    };\n\n    /**\n     * Creates and returns a function which, when called, will resolve or reject\n     * the given promise based on how it is called:\n     *\n     * - If, when called, `chrome.runtime.lastError` contains a non-null object,\n     *   the promise is rejected with that value.\n     * - If the function is called with exactly one argument, the promise is\n     *   resolved to that value.\n     * - Otherwise, the promise is resolved to an array containing all of the\n     *   function's arguments.\n     *\n     * @param {object} promise\n     *        An object containing the resolution and rejection functions of a\n     *        promise.\n     * @param {function} promise.resolve\n     *        The promise's resolution function.\n     * @param {function} promise.reject\n     *        The promise's rejection function.\n     * @param {object} metadata\n     *        Metadata about the wrapped method which has created the callback.\n     * @param {boolean} metadata.singleCallbackArg\n     *        Whether or not the promise is resolved with only the first\n     *        argument of the callback, alternatively an array of all the\n     *        callback arguments is resolved. By default, if the callback\n     *        function is invoked with only a single argument, that will be\n     *        resolved to the promise, while all arguments will be resolved as\n     *        an array if multiple are given.\n     *\n     * @returns {function}\n     *        The generated callback function.\n     */\n    const makeCallback = (promise, metadata) => {\n      return (...callbackArgs) => {\n        if (extensionAPIs.runtime.lastError) {\n          promise.reject(new Error(extensionAPIs.runtime.lastError.message));\n        } else if (metadata.singleCallbackArg ||\n                   (callbackArgs.length <= 1 && metadata.singleCallbackArg !== false)) {\n          promise.resolve(callbackArgs[0]);\n        } else {\n          promise.resolve(callbackArgs);\n        }\n      };\n    };\n\n    const pluralizeArguments = (numArgs) => numArgs == 1 ? \"argument\" : \"arguments\";\n\n    /**\n     * Creates a wrapper function for a method with the given name and metadata.\n     *\n     * @param {string} name\n     *        The name of the method which is being wrapped.\n     * @param {object} metadata\n     *        Metadata about the method being wrapped.\n     * @param {integer} metadata.minArgs\n     *        The minimum number of arguments which must be passed to the\n     *        function. If called with fewer than this number of arguments, the\n     *        wrapper will raise an exception.\n     * @param {integer} metadata.maxArgs\n     *        The maximum number of arguments which may be passed to the\n     *        function. If called with more than this number of arguments, the\n     *        wrapper will raise an exception.\n     * @param {boolean} metadata.singleCallbackArg\n     *        Whether or not the promise is resolved with only the first\n     *        argument of the callback, alternatively an array of all the\n     *        callback arguments is resolved. By default, if the callback\n     *        function is invoked with only a single argument, that will be\n     *        resolved to the promise, while all arguments will be resolved as\n     *        an array if multiple are given.\n     *\n     * @returns {function(object, ...*)}\n     *       The generated wrapper function.\n     */\n    const wrapAsyncFunction = (name, metadata) => {\n      return function asyncFunctionWrapper(target, ...args) {\n        if (args.length < metadata.minArgs) {\n          throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        if (args.length > metadata.maxArgs) {\n          throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        return new Promise((resolve, reject) => {\n          if (metadata.fallbackToNoCallback) {\n            // This API method has currently no callback on Chrome, but it return a promise on Firefox,\n            // and so the polyfill will try to call it with a callback first, and it will fallback\n            // to not passing the callback if the first call fails.\n            try {\n              target[name](...args, makeCallback({resolve, reject}, metadata));\n            } catch (cbError) {\n              console.warn(`${name} API method doesn't seem to support the callback parameter, ` +\n                           \"falling back to call it without a callback: \", cbError);\n\n              target[name](...args);\n\n              // Update the API method metadata, so that the next API calls will not try to\n              // use the unsupported callback anymore.\n              metadata.fallbackToNoCallback = false;\n              metadata.noCallback = true;\n\n              resolve();\n            }\n          } else if (metadata.noCallback) {\n            target[name](...args);\n            resolve();\n          } else {\n            target[name](...args, makeCallback({resolve, reject}, metadata));\n          }\n        });\n      };\n    };\n\n    /**\n     * Wraps an existing method of the target object, so that calls to it are\n     * intercepted by the given wrapper function. The wrapper function receives,\n     * as its first argument, the original `target` object, followed by each of\n     * the arguments passed to the original method.\n     *\n     * @param {object} target\n     *        The original target object that the wrapped method belongs to.\n     * @param {function} method\n     *        The method being wrapped. This is used as the target of the Proxy\n     *        object which is created to wrap the method.\n     * @param {function} wrapper\n     *        The wrapper function which is called in place of a direct invocation\n     *        of the wrapped method.\n     *\n     * @returns {Proxy<function>}\n     *        A Proxy object for the given method, which invokes the given wrapper\n     *        method in its place.\n     */\n    const wrapMethod = (target, method, wrapper) => {\n      return new Proxy(method, {\n        apply(targetMethod, thisObj, args) {\n          return wrapper.call(thisObj, target, ...args);\n        },\n      });\n    };\n\n    let hasOwnProperty = Function.call.bind(Object.prototype.hasOwnProperty);\n\n    /**\n     * Wraps an object in a Proxy which intercepts and wraps certain methods\n     * based on the given `wrappers` and `metadata` objects.\n     *\n     * @param {object} target\n     *        The target object to wrap.\n     *\n     * @param {object} [wrappers = {}]\n     *        An object tree containing wrapper functions for special cases. Any\n     *        function present in this object tree is called in place of the\n     *        method in the same location in the `target` object tree. These\n     *        wrapper methods are invoked as described in {@see wrapMethod}.\n     *\n     * @param {object} [metadata = {}]\n     *        An object tree containing metadata used to automatically generate\n     *        Promise-based wrapper functions for asynchronous. Any function in\n     *        the `target` object tree which has a corresponding metadata object\n     *        in the same location in the `metadata` tree is replaced with an\n     *        automatically-generated wrapper function, as described in\n     *        {@see wrapAsyncFunction}\n     *\n     * @returns {Proxy<object>}\n     */\n    const wrapObject = (target, wrappers = {}, metadata = {}) => {\n      let cache = Object.create(null);\n      let handlers = {\n        has(proxyTarget, prop) {\n          return prop in target || prop in cache;\n        },\n\n        get(proxyTarget, prop, receiver) {\n          if (prop in cache) {\n            return cache[prop];\n          }\n\n          if (!(prop in target)) {\n            return undefined;\n          }\n\n          let value = target[prop];\n\n          if (typeof value === \"function\") {\n            // This is a method on the underlying object. Check if we need to do\n            // any wrapping.\n\n            if (typeof wrappers[prop] === \"function\") {\n              // We have a special-case wrapper for this method.\n              value = wrapMethod(target, target[prop], wrappers[prop]);\n            } else if (hasOwnProperty(metadata, prop)) {\n              // This is an async method that we have metadata for. Create a\n              // Promise wrapper for it.\n              let wrapper = wrapAsyncFunction(prop, metadata[prop]);\n              value = wrapMethod(target, target[prop], wrapper);\n            } else {\n              // This is a method that we don't know or care about. Return the\n              // original method, bound to the underlying object.\n              value = value.bind(target);\n            }\n          } else if (typeof value === \"object\" && value !== null &&\n                     (hasOwnProperty(wrappers, prop) ||\n                      hasOwnProperty(metadata, prop))) {\n            // This is an object that we need to do some wrapping for the children\n            // of. Create a sub-object wrapper for it with the appropriate child\n            // metadata.\n            value = wrapObject(value, wrappers[prop], metadata[prop]);\n          } else if (hasOwnProperty(metadata, \"*\")) {\n            // Wrap all properties in * namespace.\n            value = wrapObject(value, wrappers[prop], metadata[\"*\"]);\n          } else {\n            // We don't need to do any wrapping for this property,\n            // so just forward all access to the underlying object.\n            Object.defineProperty(cache, prop, {\n              configurable: true,\n              enumerable: true,\n              get() {\n                return target[prop];\n              },\n              set(value) {\n                target[prop] = value;\n              },\n            });\n\n            return value;\n          }\n\n          cache[prop] = value;\n          return value;\n        },\n\n        set(proxyTarget, prop, value, receiver) {\n          if (prop in cache) {\n            cache[prop] = value;\n          } else {\n            target[prop] = value;\n          }\n          return true;\n        },\n\n        defineProperty(proxyTarget, prop, desc) {\n          return Reflect.defineProperty(cache, prop, desc);\n        },\n\n        deleteProperty(proxyTarget, prop) {\n          return Reflect.deleteProperty(cache, prop);\n        },\n      };\n\n      // Per contract of the Proxy API, the \"get\" proxy handler must return the\n      // original value of the target if that value is declared read-only and\n      // non-configurable. For this reason, we create an object with the\n      // prototype set to `target` instead of using `target` directly.\n      // Otherwise we cannot return a custom object for APIs that\n      // are declared read-only and non-configurable, such as `chrome.devtools`.\n      //\n      // The proxy handlers themselves will still use the original `target`\n      // instead of the `proxyTarget`, so that the methods and properties are\n      // dereferenced via the original targets.\n      let proxyTarget = Object.create(target);\n      return new Proxy(proxyTarget, handlers);\n    };\n\n    /**\n     * Creates a set of wrapper functions for an event object, which handles\n     * wrapping of listener functions that those messages are passed.\n     *\n     * A single wrapper is created for each listener function, and stored in a\n     * map. Subsequent calls to `addListener`, `hasListener`, or `removeListener`\n     * retrieve the original wrapper, so that  attempts to remove a\n     * previously-added listener work as expected.\n     *\n     * @param {DefaultWeakMap<function, function>} wrapperMap\n     *        A DefaultWeakMap object which will create the appropriate wrapper\n     *        for a given listener function when one does not exist, and retrieve\n     *        an existing one when it does.\n     *\n     * @returns {object}\n     */\n    const wrapEvent = wrapperMap => ({\n      addListener(target, listener, ...args) {\n        target.addListener(wrapperMap.get(listener), ...args);\n      },\n\n      hasListener(target, listener) {\n        return target.hasListener(wrapperMap.get(listener));\n      },\n\n      removeListener(target, listener) {\n        target.removeListener(wrapperMap.get(listener));\n      },\n    });\n\n    const onRequestFinishedWrappers = new DefaultWeakMap(listener => {\n      if (typeof listener !== \"function\") {\n        return listener;\n      }\n\n      /**\n       * Wraps an onRequestFinished listener function so that it will return a\n       * `getContent()` property which returns a `Promise` rather than using a\n       * callback API.\n       *\n       * @param {object} req\n       *        The HAR entry object representing the network request.\n       */\n      return function onRequestFinished(req) {\n        const wrappedReq = wrapObject(req, {} /* wrappers */, {\n          getContent: {\n            minArgs: 0,\n            maxArgs: 0,\n          },\n        });\n        listener(wrappedReq);\n      };\n    });\n\n    // Keep track if the deprecation warning has been logged at least once.\n    let loggedSendResponseDeprecationWarning = false;\n\n    const onMessageWrappers = new DefaultWeakMap(listener => {\n      if (typeof listener !== \"function\") {\n        return listener;\n      }\n\n      /**\n       * Wraps a message listener function so that it may send responses based on\n       * its return value, rather than by returning a sentinel value and calling a\n       * callback. If the listener function returns a Promise, the response is\n       * sent when the promise either resolves or rejects.\n       *\n       * @param {*} message\n       *        The message sent by the other end of the channel.\n       * @param {object} sender\n       *        Details about the sender of the message.\n       * @param {function(*)} sendResponse\n       *        A callback which, when called with an arbitrary argument, sends\n       *        that value as a response.\n       * @returns {boolean}\n       *        True if the wrapped listener returned a Promise, which will later\n       *        yield a response. False otherwise.\n       */\n      return function onMessage(message, sender, sendResponse) {\n        let didCallSendResponse = false;\n\n        let wrappedSendResponse;\n        let sendResponsePromise = new Promise(resolve => {\n          wrappedSendResponse = function(response) {\n            if (!loggedSendResponseDeprecationWarning) {\n              console.warn(SEND_RESPONSE_DEPRECATION_WARNING, new Error().stack);\n              loggedSendResponseDeprecationWarning = true;\n            }\n            didCallSendResponse = true;\n            resolve(response);\n          };\n        });\n\n        let result;\n        try {\n          result = listener(message, sender, wrappedSendResponse);\n        } catch (err) {\n          result = Promise.reject(err);\n        }\n\n        const isResultThenable = result !== true && isThenable(result);\n\n        // If the listener didn't returned true or a Promise, or called\n        // wrappedSendResponse synchronously, we can exit earlier\n        // because there will be no response sent from this listener.\n        if (result !== true && !isResultThenable && !didCallSendResponse) {\n          return false;\n        }\n\n        // A small helper to send the message if the promise resolves\n        // and an error if the promise rejects (a wrapped sendMessage has\n        // to translate the message into a resolved promise or a rejected\n        // promise).\n        const sendPromisedResult = (promise) => {\n          promise.then(msg => {\n            // send the message value.\n            sendResponse(msg);\n          }, error => {\n            // Send a JSON representation of the error if the rejected value\n            // is an instance of error, or the object itself otherwise.\n            let message;\n            if (error && (error instanceof Error ||\n                typeof error.message === \"string\")) {\n              message = error.message;\n            } else {\n              message = \"An unexpected error occurred\";\n            }\n\n            sendResponse({\n              __mozWebExtensionPolyfillReject__: true,\n              message,\n            });\n          }).catch(err => {\n            // Print an error on the console if unable to send the response.\n            console.error(\"Failed to send onMessage rejected reply\", err);\n          });\n        };\n\n        // If the listener returned a Promise, send the resolved value as a\n        // result, otherwise wait the promise related to the wrappedSendResponse\n        // callback to resolve and send it as a response.\n        if (isResultThenable) {\n          sendPromisedResult(result);\n        } else {\n          sendPromisedResult(sendResponsePromise);\n        }\n\n        // Let Chrome know that the listener is replying.\n        return true;\n      };\n    });\n\n    const wrappedSendMessageCallback = ({reject, resolve}, reply) => {\n      if (extensionAPIs.runtime.lastError) {\n        // Detect when none of the listeners replied to the sendMessage call and resolve\n        // the promise to undefined as in Firefox.\n        // See https://github.com/mozilla/webextension-polyfill/issues/130\n        if (extensionAPIs.runtime.lastError.message === CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE) {\n          resolve();\n        } else {\n          reject(new Error(extensionAPIs.runtime.lastError.message));\n        }\n      } else if (reply && reply.__mozWebExtensionPolyfillReject__) {\n        // Convert back the JSON representation of the error into\n        // an Error instance.\n        reject(new Error(reply.message));\n      } else {\n        resolve(reply);\n      }\n    };\n\n    const wrappedSendMessage = (name, metadata, apiNamespaceObj, ...args) => {\n      if (args.length < metadata.minArgs) {\n        throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n      }\n\n      if (args.length > metadata.maxArgs) {\n        throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n      }\n\n      return new Promise((resolve, reject) => {\n        const wrappedCb = wrappedSendMessageCallback.bind(null, {resolve, reject});\n        args.push(wrappedCb);\n        apiNamespaceObj.sendMessage(...args);\n      });\n    };\n\n    const staticWrappers = {\n      devtools: {\n        network: {\n          onRequestFinished: wrapEvent(onRequestFinishedWrappers),\n        },\n      },\n      runtime: {\n        onMessage: wrapEvent(onMessageWrappers),\n        onMessageExternal: wrapEvent(onMessageWrappers),\n        sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {minArgs: 1, maxArgs: 3}),\n      },\n      tabs: {\n        sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {minArgs: 2, maxArgs: 3}),\n      },\n    };\n    const settingMetadata = {\n      clear: {minArgs: 1, maxArgs: 1},\n      get: {minArgs: 1, maxArgs: 1},\n      set: {minArgs: 1, maxArgs: 1},\n    };\n    apiMetadata.privacy = {\n      network: {\"*\": settingMetadata},\n      services: {\"*\": settingMetadata},\n      websites: {\"*\": settingMetadata},\n    };\n\n    return wrapObject(extensionAPIs, staticWrappers, apiMetadata);\n  };\n\n  if (typeof chrome != \"object\" || !chrome || !chrome.runtime || !chrome.runtime.id) {\n    throw new Error(\"This script should only be loaded in a browser extension.\");\n  }\n\n  // The build process adds a UMD wrapper around this file, which makes the\n  // `module` variable available.\n  module.exports = wrapAPIs(chrome);\n} else {\n  module.exports = browser;\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\nexports.browser = require(\"webextension-polyfill\");\n","import { createComparator } from './comparator';\nimport { createCircularEqualCreator, sameValueZeroEqual } from './utils';\n\nexport { createComparator as createCustomEqual, sameValueZeroEqual };\n\nexport const deepEqual = createComparator();\nexport const shallowEqual = createComparator(() => sameValueZeroEqual);\n\nexport const circularDeepEqual = createComparator(createCircularEqualCreator());\nexport const circularShallowEqual = createComparator(\n  createCircularEqualCreator(sameValueZeroEqual),\n);\n","const HAS_WEAKSET_SUPPORT = typeof WeakSet === 'function';\n\nconst { keys } = Object;\n\ntype Cache = {\n  add: (value: any) => void;\n  has: (value: any) => boolean;\n};\n\nexport type EqualityComparator = (a: any, b: any, meta?: any) => boolean;\n\n/**\n * are the values passed strictly equal or both NaN\n *\n * @param a the value to compare against\n * @param b the value to test\n * @returns are the values equal by the SameValueZero principle\n */\nexport function sameValueZeroEqual(a: any, b: any) {\n  return a === b || (a !== a && b !== b);\n}\n\n/**\n * is the value a plain object\n *\n * @param value the value to test\n * @returns is the value a plain object\n */\nexport function isPlainObject(value: any) {\n  return value.constructor === Object || value.constructor == null;\n}\n\n/**\n * is the value promise-like (meaning it is thenable)\n *\n * @param value the value to test\n * @returns is the value promise-like\n */\nexport function isPromiseLike(value: any) {\n  return !!value && typeof value.then === 'function';\n}\n\n/**\n * is the value passed a react element\n *\n * @param value the value to test\n * @returns is the value a react element\n */\nexport function isReactElement(value: any) {\n  return !!(value && value.$$typeof);\n}\n\n/**\n * in cases where WeakSet is not supported, creates a new custom\n * object that mimics the necessary API aspects for cache purposes\n *\n * @returns the new cache object\n */\nexport function getNewCacheFallback(): Cache {\n  const values: any[] = [];\n\n  return {\n    add(value: any) {\n      values.push(value);\n    },\n\n    has(value: any) {\n      return values.indexOf(value) !== -1;\n    },\n  };\n}\n\n/**\n * get a new cache object to prevent circular references\n *\n * @returns the new cache object\n */\nexport const getNewCache = ((canUseWeakMap: boolean) => {\n  if (canUseWeakMap) {\n    return function _getNewCache(): Cache {\n      return new WeakSet();\n    };\n  }\n\n  return getNewCacheFallback;\n})(HAS_WEAKSET_SUPPORT);\n\n/**\n * create a custom isEqual handler specific to circular objects\n *\n * @param [isEqual] the isEqual comparator to use instead of isDeepEqual\n * @returns the method to create the `isEqual` function\n */\nexport function createCircularEqualCreator(isEqual?: EqualityComparator) {\n  return function createCircularEqual(comparator: EqualityComparator) {\n    const _comparator = isEqual || comparator;\n\n    return function circularEqual(\n      a: any,\n      b: any,\n      cache: Cache = getNewCache(),\n    ) {\n      const isCacheableA = !!a && typeof a === 'object';\n      const isCacheableB = !!b && typeof b === 'object';\n\n      if (isCacheableA || isCacheableB) {\n        const hasA = isCacheableA && cache.has(a);\n        const hasB = isCacheableB && cache.has(b);\n\n        if (hasA || hasB) {\n          return hasA && hasB;\n        }\n\n        if (isCacheableA) {\n          cache.add(a);\n        }\n\n        if (isCacheableB) {\n          cache.add(b);\n        }\n      }\n\n      return _comparator(a, b, cache);\n    };\n  };\n}\n\n/**\n * are the arrays equal in value\n *\n * @param a the array to test\n * @param b the array to test against\n * @param isEqual the comparator to determine equality\n * @param meta the meta object to pass through\n * @returns are the arrays equal\n */\nexport function areArraysEqual(\n  a: any[],\n  b: any[],\n  isEqual: EqualityComparator,\n  meta: any,\n) {\n  let index = a.length;\n\n  if (b.length !== index) {\n    return false;\n  }\n\n  while (index-- > 0) {\n    if (!isEqual(a[index], b[index], meta)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * are the maps equal in value\n *\n * @param a the map to test\n * @param b the map to test against\n * @param isEqual the comparator to determine equality\n * @param meta the meta map to pass through\n * @returns are the maps equal\n */\nexport function areMapsEqual(\n  a: Map<any, any>,\n  b: Map<any, any>,\n  isEqual: EqualityComparator,\n  meta: any,\n) {\n  let isValueEqual = a.size === b.size;\n\n  if (isValueEqual && a.size) {\n    a.forEach((aValue, aKey) => {\n      if (isValueEqual) {\n        isValueEqual = false;\n\n        b.forEach((bValue, bKey) => {\n          if (!isValueEqual && isEqual(aKey, bKey, meta)) {\n            isValueEqual = isEqual(aValue, bValue, meta);\n          }\n        });\n      }\n    });\n  }\n\n  return isValueEqual;\n}\n\ntype Dictionary<Type> = {\n  [key: string]: Type;\n  [index: number]: Type;\n};\n\nconst OWNER = '_owner';\n\nconst hasOwnProperty = Function.prototype.bind.call(\n  Function.prototype.call,\n  Object.prototype.hasOwnProperty,\n);\n\n/**\n * are the objects equal in value\n *\n * @param a the object to test\n * @param b the object to test against\n * @param isEqual the comparator to determine equality\n * @param meta the meta object to pass through\n * @returns are the objects equal\n */\nexport function areObjectsEqual(\n  a: Dictionary<any>,\n  b: Dictionary<any>,\n  isEqual: EqualityComparator,\n  meta: any,\n) {\n  const keysA = keys(a);\n\n  let index = keysA.length;\n\n  if (keys(b).length !== index) {\n    return false;\n  }\n\n  if (index) {\n    let key: string;\n\n    while (index-- > 0) {\n      key = keysA[index];\n\n      if (key === OWNER) {\n        const reactElementA = isReactElement(a);\n        const reactElementB = isReactElement(b);\n\n        if (\n          (reactElementA || reactElementB) &&\n          reactElementA !== reactElementB\n        ) {\n          return false;\n        }\n      }\n\n      if (!hasOwnProperty(b, key) || !isEqual(a[key], b[key], meta)) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n}\n\n/**\n * are the regExps equal in value\n *\n * @param a the regExp to test\n * @param b the regExp to test agains\n * @returns are the regExps equal\n */\nexport function areRegExpsEqual(a: RegExp, b: RegExp) {\n  return (\n    a.source === b.source &&\n    a.global === b.global &&\n    a.ignoreCase === b.ignoreCase &&\n    a.multiline === b.multiline &&\n    a.unicode === b.unicode &&\n    a.sticky === b.sticky &&\n    a.lastIndex === b.lastIndex\n  );\n}\n\n/**\n * are the sets equal in value\n *\n * @param a the set to test\n * @param b the set to test against\n * @param isEqual the comparator to determine equality\n * @param meta the meta set to pass through\n * @returns are the sets equal\n */\nexport function areSetsEqual(\n  a: Set<any>,\n  b: Set<any>,\n  isEqual: EqualityComparator,\n  meta: any,\n) {\n  let isValueEqual = a.size === b.size;\n\n  if (isValueEqual && a.size) {\n    a.forEach((aValue) => {\n      if (isValueEqual) {\n        isValueEqual = false;\n\n        b.forEach((bValue) => {\n          if (!isValueEqual) {\n            isValueEqual = isEqual(aValue, bValue, meta);\n          }\n        });\n      }\n    });\n  }\n\n  return isValueEqual;\n}\n","import {\n  EqualityComparator,\n  areArraysEqual,\n  areMapsEqual,\n  areObjectsEqual,\n  areRegExpsEqual,\n  areSetsEqual,\n  isPlainObject,\n  isPromiseLike,\n  sameValueZeroEqual,\n} from './utils';\n\nconst HAS_MAP_SUPPORT = typeof Map === 'function';\nconst HAS_SET_SUPPORT = typeof Set === 'function';\n\ntype EqualityComparatorCreator = (fn: EqualityComparator) => EqualityComparator;\n\nexport function createComparator(createIsEqual?: EqualityComparatorCreator) {\n  const isEqual: EqualityComparator =\n    /* eslint-disable no-use-before-define */\n    typeof createIsEqual === 'function'\n      ? createIsEqual(comparator)\n      : comparator;\n  /* eslint-enable */\n\n  /**\n   * compare the value of the two objects and return true if they are equivalent in values\n   *\n   * @param a the value to test against\n   * @param b the value to test\n   * @param [meta] an optional meta object that is passed through to all equality test calls\n   * @returns are a and b equivalent in value\n   */\n  function comparator(a: any, b: any, meta?: any) {\n    if (a === b) {\n      return true;\n    }\n\n    if (a && b && typeof a === 'object' && typeof b === 'object') {\n      if (isPlainObject(a) && isPlainObject(b)) {\n        return areObjectsEqual(a, b, isEqual, meta);\n      }\n\n      let aShape = Array.isArray(a);\n      let bShape = Array.isArray(b);\n\n      if (aShape || bShape) {\n        return aShape === bShape && areArraysEqual(a, b, isEqual, meta);\n      }\n\n      aShape = a instanceof Date;\n      bShape = b instanceof Date;\n\n      if (aShape || bShape) {\n        return (\n          aShape === bShape && sameValueZeroEqual(a.getTime(), b.getTime())\n        );\n      }\n\n      aShape = a instanceof RegExp;\n      bShape = b instanceof RegExp;\n\n      if (aShape || bShape) {\n        return aShape === bShape && areRegExpsEqual(a, b);\n      }\n\n      if (isPromiseLike(a) || isPromiseLike(b)) {\n        return a === b;\n      }\n\n      if (HAS_MAP_SUPPORT) {\n        aShape = a instanceof Map;\n        bShape = b instanceof Map;\n\n        if (aShape || bShape) {\n          return aShape === bShape && areMapsEqual(a, b, isEqual, meta);\n        }\n      }\n\n      if (HAS_SET_SUPPORT) {\n        aShape = a instanceof Set;\n        bShape = b instanceof Set;\n\n        if (aShape || bShape) {\n          return aShape === bShape && areSetsEqual(a, b, isEqual, meta);\n        }\n      }\n\n      return areObjectsEqual(a, b, isEqual, meta);\n    }\n\n    return a !== a && b !== b;\n  }\n\n  return comparator;\n}\n","import {Opaque} from \"type-fest\";\n\n// bar or foo or *\ntype Name = Opaque<string, \"name\">;\n// [bar, foo, *]\ntype Tail = Opaque<Name[], \"tail\">;\n// *.foo.bar.com -> tld=com, tail=[bar, foo, *]\ninterface DomainSpec {\n    tail: Tail;\n    tld: Name;\n}\n\nfunction fallsUnderName(name: Name, filter: Name): boolean {\n    return filter === name || filter === \"*\";\n}\n\nfunction fallsUnderTail(tail: Tail, filter: Tail): boolean {\n    if (filter.length !== tail.length) {\n        return false;\n    }\n\n    return Array(filter.length)\n        .fill(0)\n        .map((_, index) => index)\n        .every(i => fallsUnderName(tail[i]!, filter[i]!));\n}\n\nfunction toDomainFilter(domain: string): DomainSpec {\n    const [tld, ...tail] = domain.split(\".\").reverse();\n    return {\n        tail: tail as Tail,\n        tld: tld as Name\n    };\n}\n\nfunction getOrNew<K, V>(key: K, map: Map<K, Set<V>>): Set<V> {\n    const entry = map.get(key);\n    if (entry == null) {\n        const set = new Set<V>();\n        map.set(key, set);\n        return set;\n    } else {\n        return entry;\n    }\n}\n\nfunction matches(tree: Map<Name, Set<Tail>>, domain: string): boolean {\n    const target = toDomainFilter(domain);\n    const filtersForTld = tree.get(target.tld);\n\n    return filtersForTld == null ? false : Array.from(filtersForTld).some(filter => fallsUnderTail(target.tail, filter));\n}\n\nexport type DomainFilter = (domain: string) => boolean;\n\nexport function domainFilterFrom(domains: readonly string[]): DomainFilter {\n    const tree = new Map<Name, Set<Tail>>();\n\n    domains.map(toDomainFilter).forEach(filter => getOrNew(filter.tld, tree).add(filter.tail));\n\n    return (domain: string): boolean => matches(tree, domain);\n}\n\n// matches \"foo.*.bar\"\nexport const DOMAIN_NAME_FILTER_PATTERN = /^(?:(?:[\\w-]+|\\*)\\.)*(?:[\\w-]+|\\*)$/iu;\n","import {JsonValue} from \"type-fest\";\n\nexport function bool(def: boolean) {\n    return (input: unknown): boolean => (typeof input === \"boolean\" ? input : def);\n}\n\nexport function num(def: number, ...validators: ((i: number) => boolean)[]) {\n    return (input: unknown): number => (typeof input === \"number\" && validators.every(val => val(input)) ? input : def);\n}\n\nexport function str(def: string, ...validators: ((i: string) => boolean)[]) {\n    return (input: unknown): string => (typeof input === \"string\" && validators.every(val => val(input)) ? input : def);\n}\n\nexport function stringEnum<T extends string>(enumType: Record<string, T>, def: T) {\n    return (input: unknown): T => {\n        const isValid =\n            typeof input === \"string\" &&\n            Object.values(enumType)\n                .map(entry => entry as string)\n                .includes(input);\n        return isValid ? (input as T) : def;\n    };\n}\n\nexport function stringArray(def: string[], ...validators: ((x: string) => boolean)[]) {\n    return (input: unknown): string[] =>\n        Array.isArray(input) && input.every(entry => typeof entry === \"string\" && validators.every(validator => validator(entry))) ? (input as string[]) : def;\n}\n\nexport function roundedTo(decimals: number) {\n    return (input: number): boolean => {\n        const multiplied = input * 10 ** decimals;\n        return multiplied === Math.round(multiplied);\n    };\n}\n\nexport function matching(regex: RegExp) {\n    return (input: string): boolean => regex.test(input);\n}\n\nexport function notBlank(value: string): boolean {\n    return value.trim().length > 0;\n}\n\nexport function gt(min: number) {\n    return (input: number): boolean => input > min;\n}\n\nexport function gte(min: number) {\n    return (input: number): boolean => input >= min;\n}\n\nexport function lte(max: number) {\n    return (input: number): boolean => input <= max;\n}\n\nexport function sanitize<T, K extends keyof T = keyof T>(source: Record<K, JsonValue>, spec: Record<K, (x: unknown) => T[K]>): T {\n    const destination: Partial<T> = {};\n\n    for (const field of Object.getOwnPropertyNames(spec) as K[]) {\n        if (Object.prototype.hasOwnProperty.call(spec, field)) {\n            const validator = spec[field];\n            const sourceValue = source[field];\n\n            destination[field] = validator(sourceValue);\n        }\n    }\n\n    return destination as T;\n}\n","export enum ClickType {\n    none = \"none\",\n    singleLeft = \"singleLeft\",\n    doubleLeft = \"doubleLeft\",\n    singleRight = \"singleRight\",\n    doubleRight = \"doubleRight\"\n}\n\nexport enum HoverButtonPosition {\n    // corners\n    topLeftNE = \"1_2\",\n    topLeftSW = \"1_3\",\n    topLeftSE = \"1_4\",\n\n    topRightNW = \"2_1\",\n    topRightSW = \"2_3\",\n    topRightSE = \"2_4\",\n\n    bottomLeftNW = \"3_1\",\n    bottomleftNE = \"3_2\",\n    bottomLeftSE = \"3_4\",\n\n    bottomRightNW = \"4_1\",\n    bottomRightNE = \"4_2\",\n    bottomRightSW = \"4_3\",\n\n    // axis\n    northNorth = \"1\",\n    north = \"2\",\n    westWest = \"3\",\n    west = \"4\",\n    center = \"5\",\n    east = \"6\",\n    eastEast = \"7\",\n    south = \"8\",\n    southSouth = \"9\"\n}\n\nexport enum HoverButtonSkin {\n    original = \"original\",\n    alt1 = \"alt1\"\n}\n\nexport enum ConflictAction {\n    autoUnique = \"uniquify\",\n    // TODO firefox support\n    prompt = \"prompt\",\n    overwrite = \"overwrite\"\n}\n\n// *_DIRS = url path as nested dirs\n// *_PATH = url path as 1 dot-concatenated dir\nexport enum FilenameVariables {\n    tabDomain = \"%pagedomain%\",\n    tabDirs = \"%pagedirs%\",\n    tabPath = \"%pagepath%\",\n    tabTitle = \"%title%\",\n\n    imageDomain = \"%imagedomain%\",\n    imageDirs = \"%imagedirs%\",\n    imagePath = \"%imagepath%\",\n\n    counter = \"%counter%\",\n    inferred = \"%original%\",\n\n    year = \"%y%\",\n    month = \"%M%\",\n    day = \"%d%\",\n    hour = \"%h%\",\n    minute = \"%m%\",\n    second = \"%s%\",\n    millisecond = \"%ms%\"\n}\n","import {JsonValue} from \"type-fest\";\nimport {browser} from \"webextension-polyfill-ts\";\nimport {DOMAIN_NAME_FILTER_PATTERN} from \"../filtering\";\nimport {bool, gt, gte, lte, matching, notBlank, num, roundedTo, sanitize, str, stringArray, stringEnum} from \"./validation\";\nimport {ClickType, ConflictAction, FilenameVariables, HoverButtonPosition, HoverButtonSkin} from \"./enums\";\n\nconst spec = {\n    aggressiveCursorTracking: bool(false),\n    buttonOpacity: num(1, gte(0.1), lte(1), roundedTo(2)),\n    buttonPosition: stringEnum(HoverButtonPosition, HoverButtonPosition.topRightSW),\n    buttonSize: num(48, Number.isInteger, gte(8), lte(512)),\n    counterPadding: num(1, Number.isInteger, gte(0)),\n    counterStart: num(1, Number.isInteger, gte(0)),\n    counterStep: num(1, Number.isInteger, gte(0)),\n    doubleRightClickMillis: num(250, Number.isInteger, gt(0)),\n    enableImageContextMenu: bool(true),\n    enableRename: bool(false),\n    enableSelectionContextMenu: bool(true),\n    excludedPageDomains: stringArray([], matching(DOMAIN_NAME_FILTER_PATTERN)),\n    excludedSourceDomains: stringArray([], matching(DOMAIN_NAME_FILTER_PATTERN)),\n    fileNamePattern: str(FilenameVariables.inferred, notBlank),\n    greyOut: bool(true),\n    minimumImageSize: num(100, Number.isInteger, gte(1)),\n    notify: bool(false),\n    onFilenameConflict: stringEnum(ConflictAction, ConflictAction.autoUnique),\n    oneClickStyle: stringEnum(HoverButtonSkin, HoverButtonSkin.alt1),\n    pageDomainsAreWhitelist: bool(false),\n    persist: bool(false),\n    requireShift: bool(false),\n    singleClickEnabled: bool(false),\n    sourceDomainsAreWhitelist: bool(false),\n    supportDragDrop: bool(true),\n    triggerByClickType: stringEnum(ClickType, ClickType.doubleLeft)\n};\n\nexport type Settings = {\n    readonly [P in keyof typeof spec]: ReturnType<typeof spec[P]>;\n};\n\nexport function isSetting(key: string): key is keyof Settings {\n    return key in spec;\n}\n\nexport async function read(): Promise<Record<keyof Settings, JsonValue>> {\n    const json = await browser.storage.sync.get(Object.keys(spec));\n    return json as Record<keyof Settings, JsonValue>;\n}\n\nexport async function write(dto: Partial<Settings>): Promise<void> {\n    return browser.storage.sync.set(dto);\n}\n\nexport function correct(raw: Record<keyof Settings, JsonValue>): Settings {\n    return sanitize<Settings>(raw, spec);\n}\n","import {deepEqual} from \"fast-equals\";\nimport {correct, read, Settings, write} from \"./io\";\n\nexport async function load(): Promise<Settings> {\n    const raw = await read();\n    return correct(raw);\n}\n\nexport async function validate(): Promise<boolean> {\n    const raw = await read();\n    const validated = correct(raw);\n\n    if (deepEqual(validated, raw)) {\n        return true;\n    } else {\n        await write(validated);\n        return false;\n    }\n}\n\nexport function passesShiftKeySetting(event: MouseEvent, settings: Settings): boolean {\n    return !settings.requireShift || event.shiftKey;\n}\n\nexport function passesSizeRestrictions(image: HTMLImageElement, settings: Settings): boolean {\n    return image.width > settings.minimumImageSize && image.height > settings.minimumImageSize;\n}\n","import {Storage, browser} from \"webextension-polyfill-ts\";\nimport {load} from \"./settings\";\nimport {isSetting, Settings} from \"./io\";\n\ntype SettingListener = (settings: Settings) => void;\nconst callbacks = new Map<keyof Settings, SettingListener[]>();\n\nasync function triggerListeners(changes: (keyof Settings)[]): Promise<void> {\n    const settings = await load();\n\n    const cbs = changes.flatMap(property => callbacks.get(property) ?? []).map(cb => cb(settings));\n\n    await Promise.all(cbs);\n}\n\nfunction getOrSet<K, V>(map: Map<K, V>, key: K, fallback: V): V {\n    const existing = map.get(key);\n    if (existing == null) {\n        map.set(key, fallback);\n        return fallback;\n    } else {\n        return existing;\n    }\n}\n\nexport function monitor(setting: keyof Settings, listener: SettingListener): void {\n    getOrSet(callbacks, setting, []).push(listener);\n}\n\nasync function inspectChanges(changes: Record<string, Storage.StorageChange | undefined>, area: string): Promise<void> {\n    if (area === \"sync\") {\n        const keys = Object.keys(changes).flatMap(key => (isSetting(key) ? [key] : []));\n        await triggerListeners(keys);\n    }\n}\n\nexport function monitorStorage(): void {\n    browser.storage.onChanged.addListener((changes, area) => void inspectChanges(changes, area).catch(console.error));\n}\n","import {Settings} from \"../common/settings/io\";\nimport {monitor} from \"../common/settings/monitoring\";\n\ntype Coordinates = [x: number, y: number];\n\nlet lastPosition: Coordinates | null = null;\n\nfunction updatePosition(event: MouseEvent): void {\n    lastPosition = [event.clientX, event.clientY];\n}\n\nexport function trackCursor(settings: Settings): void {\n    if (settings.aggressiveCursorTracking) {\n        document.addEventListener(\"mousemove\", updatePosition);\n    } else {\n        document.removeEventListener(\"mousemove\", updatePosition);\n    }\n}\n\nmonitor(\"aggressiveCursorTracking\", trackCursor);\n\nexport function getLastPosition(): Coordinates | null {\n    return lastPosition;\n}\n",null,null,"export function isImage(element: Element): element is HTMLImageElement {\n    return element.nodeName === \"IMG\";\n}\n\n// depth first is interesting because of e.g. <a>/<img> nesting\nexport function findImageDepthFirst(element: Node): HTMLImageElement | null {\n    for (const child of element.childNodes) {\n        if (child.nodeName === \"IMG\") {\n            return child as HTMLImageElement;\n        }\n\n        const image = findImageDepthFirst(child);\n        if (image != null) {\n            return image;\n        }\n    }\n\n    return null;\n}\n\nexport function isLeftClick(event: MouseEvent): boolean {\n    return event.button === 0;\n}\n\nexport function isRightClick(event: MouseEvent): boolean {\n    return event.button === 2;\n}\n","const signals = [\"getImagesInSelection\", \"hotkeyTriggered\"] as const;\n\nexport function signal<T extends typeof signals[number]>(subject: T): {subject: T} {\n    return {subject};\n}\n\n//\n\nconst topics = {\n    afterHotkeyTriggered: \"afterHotkeyTriggered\",\n    downloadFinished: \"downloadFinished\",\n    downloadRequested: \"downloadRequested\",\n    downloadStarted: \"downloadStarted\"\n} as const;\n\nexport type DownloadChangedMessage = {subject: typeof topics.downloadStarted | typeof topics.downloadFinished; downloadId: number};\nexport function started(downloadId: number): DownloadChangedMessage {\n    return {\n        downloadId,\n        subject: topics.downloadStarted\n    };\n}\nexport function finished(downloadId: number): DownloadChangedMessage {\n    return {\n        downloadId,\n        subject: topics.downloadFinished\n    };\n}\n\ntype RequestedMessage = {subject: typeof topics.downloadRequested; imageUrl: string};\nexport function requestDownload(image: HTMLImageElement): RequestedMessage {\n    return {\n        imageUrl: image.src,\n        subject: topics.downloadRequested\n    };\n}\n\nexport type TriggeredMessage = {subject: typeof topics.afterHotkeyTriggered; imageFound: boolean};\nexport function hotkeyTriggered(imageFound: boolean): TriggeredMessage {\n    return {\n        imageFound,\n        subject: topics.afterHotkeyTriggered\n    };\n}\n\n//\n\nconst subjects = [...signals, ...Object.values(topics)] as string[];\n\nexport type Message = ReturnType<typeof signal> | DownloadChangedMessage | RequestedMessage | TriggeredMessage;\n\nfunction hasSubject(value: {subject?: unknown}): value is {subject: string} {\n    return typeof value.subject == \"string\";\n}\n\nfunction isMessage(value: unknown): value is Message {\n    return typeof value == \"object\" && value != null && hasSubject(value) && subjects.includes(value.subject);\n}\n\nexport function asMessage(value: unknown): Message {\n    if (isMessage(value)) {\n        return value;\n    } else {\n        throw new Error(`${JSON.stringify(value)} is not a message`);\n    }\n}\n","import {browser} from \"webextension-polyfill-ts\";\nimport {asMessage, DownloadChangedMessage, requestDownload} from \"../common/messages\";\nimport {load} from \"../common/settings/settings\";\n\nconst activeClass = \"doubleclick-image-downloader-active\";\nconst downloadingImages = new Map<number, HTMLImageElement>();\n\nfunction markAsDownloading(image: HTMLImageElement, message: DownloadChangedMessage): void {\n    image.classList.add(activeClass);\n    downloadingImages.set(message.downloadId, image);\n}\n\nexport async function startDownload(image: HTMLImageElement): Promise<void> {\n    const sendMessage = browser.runtime.sendMessage(requestDownload(image)).then(asMessage);\n\n    const [response, settings] = await Promise.all([sendMessage, load()]);\n\n    if (response.subject === \"downloadStarted\") {\n        if (settings.greyOut) {\n            markAsDownloading(image, response);\n        }\n    } else {\n        throw new Error(`unexpected response ${JSON.stringify(response)}`);\n    }\n}\n\nexport function completeDownload(message: DownloadChangedMessage): void {\n    const image = downloadingImages.get(message.downloadId);\n    if (image == null) {\n        throw new Error(`unmatched image for download ${message.downloadId}`);\n    }\n\n    image.classList.remove(activeClass);\n    downloadingImages.delete(message.downloadId);\n}\n","import {DomainFilter, domainFilterFrom} from \"../../common/filtering\";\nimport {load} from \"../../common/settings/settings\";\nimport {monitor} from \"../../common/settings/monitoring\";\n\ntype Filter = {\n    filters: Promise<DomainFilter> | null;\n    invert: Promise<boolean> | null;\n};\n\nconst page: Filter = {\n    filters: null,\n    invert: null\n};\nconst image: Filter = {\n    filters: null,\n    invert: null\n};\n\nfunction monitorSettings(): void {\n    monitor(\"excludedPageDomains\", st => {\n        page.filters = Promise.resolve(domainFilterFrom(st.excludedPageDomains));\n    });\n    monitor(\"pageDomainsAreWhitelist\", st => {\n        page.invert = Promise.resolve(st.pageDomainsAreWhitelist);\n    });\n\n    monitor(\"excludedSourceDomains\", st => {\n        image.filters = Promise.resolve(domainFilterFrom(st.excludedSourceDomains));\n    });\n    monitor(\"sourceDomainsAreWhitelist\", st => {\n        image.invert = Promise.resolve(st.sourceDomainsAreWhitelist);\n    });\n}\n\nexport async function getFilterState(): Promise<[DomainFilter, boolean, DomainFilter, boolean]> {\n    if (page.filters == null || page.invert == null || image.filters == null || image.invert == null) {\n        const loading = load();\n\n        page.filters = loading.then(settings => domainFilterFrom(settings.excludedPageDomains));\n        page.invert = loading.then(settings => settings.pageDomainsAreWhitelist);\n\n        image.filters = loading.then(settings => domainFilterFrom(settings.excludedSourceDomains));\n        image.invert = loading.then(settings => settings.sourceDomainsAreWhitelist);\n\n        Promise.all([loading, page.filters, page.invert, image.filters, image.invert]).then(monitorSettings).catch(console.error);\n    }\n\n    return Promise.all([page.filters, page.invert, image.filters, image.invert]);\n}\n","import {getFilterState} from \"./state\";\n\nexport async function filteringAllows(target: HTMLImageElement | Location): Promise<boolean> {\n    const [pageMatches, pageMustMatch, imageMatches, imageMustMatch] = await getFilterState();\n\n    return target instanceof Location ? pageMatches(target.hostname) === pageMustMatch : imageMatches(new URL(target.src).hostname) === imageMustMatch;\n}\n","import {UnreachableCaseError} from \"ts-essentials\";\nimport {ClickType} from \"../common/settings/enums\";\nimport {Settings} from \"../common/settings/io\";\nimport {isImage, isLeftClick, isRightClick} from \"./dom\";\nimport {startDownload} from \"./downloads\";\nimport {passesShiftKeySetting, passesSizeRestrictions} from \"../common/settings/settings\";\nimport {filteringAllows} from \"./filtering\";\n\ntype MouseEventListener = (event: MouseEvent) => void;\ntype ClickEventType = \"click\" | \"dblclick\" | \"mouseup\";\n\nasync function downloadClickedImage(settings: Settings, event: MouseEvent): Promise<void> {\n    // cant really click anything else\n    const eventTarget = event.target as Element;\n\n    if (passesShiftKeySetting(event, settings) && (await filteringAllows(location))) {\n        // TODO fix for findImageDepthFirst: #65\n        const nearestImage = isImage(eventTarget) ? eventTarget : null;\n\n        if (nearestImage != null && passesSizeRestrictions(nearestImage, settings) && (await filteringAllows(nearestImage))) {\n            event.stopPropagation();\n            await startDownload(nearestImage);\n        }\n    }\n}\n\nasync function detectLeftClick(settings: Settings, event: MouseEvent): Promise<void> {\n    if (isLeftClick(event)) {\n        await downloadClickedImage(settings, event);\n    }\n}\n\nconst detectRightClick: (settings: Settings, event: MouseEvent) => Promise<void> = (() => {\n    let lastRightClickTime = 0;\n\n    return async (settings: Settings, event: MouseEvent) => {\n        if (isRightClick(event)) {\n            const now = Date.now();\n            const previousRightClick = lastRightClickTime;\n            lastRightClickTime = now;\n\n            if (settings.triggerByClickType === ClickType.singleRight || now - previousRightClick < settings.doubleRightClickMillis) {\n                await downloadClickedImage(settings, event);\n            }\n        }\n    };\n})();\n\nfunction createListener(settings: Settings): [ClickEventType, MouseEventListener] {\n    switch (settings.triggerByClickType) {\n        case ClickType.none:\n            throw new Error(\"can't make dummy listener\");\n\n        case ClickType.singleLeft:\n        case ClickType.doubleLeft: {\n            const listener = (event: MouseEvent): void => void detectLeftClick(settings, event).catch(console.error);\n            const clickType = settings.triggerByClickType === ClickType.singleLeft ? \"click\" : \"dblclick\";\n            return [clickType, listener];\n        }\n\n        case ClickType.singleRight:\n        case ClickType.doubleRight: {\n            const listener = (event: MouseEvent): void => void detectRightClick(settings, event).catch(console.error);\n            const clickType = \"mouseup\";\n            return [clickType, listener];\n        }\n\n        default:\n            throw new UnreachableCaseError(settings.triggerByClickType);\n    }\n}\n\nexport function monitorClicks(settings: Settings): void {\n    if (settings.triggerByClickType === ClickType.none) {\n        return;\n    }\n\n    const [clickType, listener] = createListener(settings);\n    document.addEventListener(clickType, listener);\n}\n","type Action<T> = (data: T) => void;\n\ninterface Triggerable<T> {\n    expose: {\n        unsubscribe: (key: symbol) => void;\n        subscribe: (action: Action<T>, description: string) => symbol;\n    };\n    hide: {\n        hasSubscribers: () => boolean;\n        trigger: (data: T) => void;\n    };\n}\n\nexport function triggerable<T = undefined>(): Triggerable<T> {\n    const actions = new Map<symbol, Action<T>>();\n\n    return {\n        expose: {\n            subscribe: (action, description) => {\n                const key = Symbol(description);\n                actions.set(key, action);\n                return key;\n            },\n            unsubscribe: key => actions.delete(key)\n        },\n        hide: {\n            hasSubscribers: () => actions.size > 0,\n            trigger: data => actions.forEach(action => action(data))\n        }\n    };\n}\n","import {browser} from \"webextension-polyfill-ts\";\nimport {HoverButtonSkin} from \"../../common/settings/enums\";\n\nexport const HTML_BUTTON_ID = \"singleclick-image-downloader\";\nexport const SKIN_CLASSES: Record<HoverButtonSkin, string> = {\n    [HoverButtonSkin.original]: `skin-${HoverButtonSkin.original}`,\n    [HoverButtonSkin.alt1]: `skin-${HoverButtonSkin.alt1}`\n};\n\nexport function insertCss(): void {\n    const style = document.createElement(\"style\");\n    // `sheet` is not available before insert\n    document.head.appendChild(style);\n    // https://github.com/Microsoft/TypeScript/issues/28098\n    Object.values(HoverButtonSkin).forEach(skin => {\n        const activeImg = browser.runtime.getURL(`images/download_on_${skin}.png`);\n        const inactiveImg = browser.runtime.getURL(`images/download_off_${skin}.png`);\n\n        const skinclass = SKIN_CLASSES[skin];\n        style.sheet!.insertRule(`#${HTML_BUTTON_ID}.${skinclass} {background-image: url('${inactiveImg}');}`, 0);\n        style.sheet!.insertRule(`#${HTML_BUTTON_ID}.${skinclass}:hover {background-image: url('${activeImg}');}`, 1);\n    });\n}\n","import {Settings} from \"../../common/settings/io\";\nimport {triggerable} from \"../../common/triggerable\";\nimport {HTML_BUTTON_ID, insertCss, SKIN_CLASSES} from \"./skinning\";\n\nconst button = document.createElement(\"div\");\nbutton.id = HTML_BUTTON_ID;\nbutton.title = \"Download image\";\n\nconst {hide: dropEvent, expose: drop} = triggerable();\nexport {drop};\n\nconst {hide: clickEvent, expose: click} = triggerable();\nexport {click};\n\nbutton.addEventListener(\"dragover\", event => {\n    if (dropEvent.hasSubscribers()) {\n        // make it droppable\n        event.preventDefault();\n    }\n});\nbutton.addEventListener(\"drop\", event => {\n    // prevent weird browser behavior like navigating to the image\n    event.preventDefault();\n    dropEvent.trigger(undefined);\n});\nbutton.addEventListener(\n    \"click\",\n    event => {\n        event.stopPropagation();\n        clickEvent.trigger(undefined);\n    },\n    true\n);\n\nexport function isButton(element: Element): boolean {\n    return button === element;\n}\n\nexport function isInserted(): boolean {\n    return button.parentNode != null;\n}\n\nlet everInserted = false;\nexport function insert(): void {\n    if (!everInserted) {\n        insertCss();\n        everInserted = true;\n    }\n    document.body.appendChild(button);\n}\n\nexport function unsert(): void {\n    document.body.removeChild(button);\n}\n\nexport function setSkin(settings: Settings): void {\n    button.classList.remove(...Object.values(SKIN_CLASSES));\n    button.classList.add(SKIN_CLASSES[settings.oneClickStyle]);\n}\n\nexport function setOpacity(settings: Settings): void {\n    button.style.opacity = String(settings.buttonOpacity);\n}\n\nexport function setSize(size: number): void {\n    button.style.height = `${size}px`;\n    button.style.width = `${size}px`;\n}\n\nexport function setCoordinates(x: number, y: number): void {\n    button.style.left = `${x}px`;\n    button.style.top = `${y}px`;\n}\n","import {Settings} from \"../common/settings/io\";\nimport {findImageDepthFirst, isImage} from \"./dom\";\nimport {startDownload} from \"./downloads\";\nimport {drop} from \"./hoverbutton/element\";\nimport {monitor} from \"../common/settings/monitoring\";\n\nlet dragged: Element | null = null;\nfunction setDragged(event: DragEvent): void {\n    // can't drag much else\n    dragged = event.target as Element;\n}\nfunction clearDragged(): void {\n    dragged = null;\n}\n\nfunction send(): void {\n    if (dragged == null) {\n        throw new Error(\"how did you drop without dragging?\");\n    }\n\n    const relevantImage = isImage(dragged) ? dragged : findImageDepthFirst(dragged);\n\n    if (relevantImage != null) {\n        startDownload(relevantImage).catch(console.error);\n    }\n}\n\nconst setUpOrTearDown: (settings: Settings) => void = (() => {\n    let registration: symbol | null = null;\n\n    return (settings: Settings) => {\n        if (settings.supportDragDrop) {\n            document.body.addEventListener(\"dragstart\", setDragged);\n            document.body.addEventListener(\"dragend\", clearDragged);\n            registration = drop.subscribe(() => send(), \"download dropped image\");\n        } else {\n            if (registration != null) {\n                drop.unsubscribe(registration);\n                registration = null;\n            }\n            document.body.removeEventListener(\"dragend\", clearDragged);\n            document.body.removeEventListener(\"dragstart\", setDragged);\n        }\n    };\n})();\n\nexport function monitorDrags(settings: Settings): void {\n    setUpOrTearDown(settings);\n    monitor(\"supportDragDrop\", st => setUpOrTearDown(st));\n}\n","export interface Area {\n    height: number;\n    width: number;\n}\n\nexport function ofViewport(): Area {\n    const height = Math.max(document.documentElement.clientHeight, document.body.clientHeight);\n    const width = Math.max(document.documentElement.clientWidth, document.body.clientWidth);\n\n    return {height, width};\n}\n\nexport function matching(element: Element): Area {\n    const {height, width} = element.getBoundingClientRect();\n    return {height, width};\n}\n\nexport function shrink(area: Area, size: number): Area {\n    return {height: area.height - size, width: area.width - size};\n}\n","import {HoverButtonPosition} from \"../../common/settings/enums\";\nimport {Area} from \"./area\";\n\ntype Calculator = (areaSize: number, selfSize: number) => number;\n\nconst MIN: Calculator = (_: number, self: number) => 0 - self;\nconst NEG: Calculator = () => 0;\nconst CENTER: Calculator = (area: number, self: number) => (area - self) / 2;\nconst POS: Calculator = (area: number, self: number) => area - self;\nconst MAX: Calculator = (area: number) => area;\n\nconst RELATIVE_DISTANCES: Record<HoverButtonPosition, [Calculator, Calculator]> = {\n    [HoverButtonPosition.topLeftSW]: [MIN, NEG],\n    [HoverButtonPosition.westWest]: [MIN, CENTER],\n    [HoverButtonPosition.bottomLeftNW]: [MIN, POS],\n\n    [HoverButtonPosition.topLeftNE]: [NEG, MIN],\n    [HoverButtonPosition.topLeftSE]: [NEG, NEG],\n    [HoverButtonPosition.west]: [NEG, NEG],\n    [HoverButtonPosition.bottomleftNE]: [NEG, POS],\n    [HoverButtonPosition.bottomLeftSE]: [NEG, MAX],\n\n    [HoverButtonPosition.northNorth]: [CENTER, MIN],\n    [HoverButtonPosition.north]: [CENTER, NEG],\n    [HoverButtonPosition.center]: [CENTER, CENTER],\n    [HoverButtonPosition.south]: [CENTER, POS],\n    [HoverButtonPosition.southSouth]: [CENTER, MAX],\n\n    [HoverButtonPosition.topRightNW]: [POS, MIN],\n    [HoverButtonPosition.topRightSW]: [POS, NEG],\n    [HoverButtonPosition.east]: [POS, CENTER],\n    [HoverButtonPosition.bottomRightNW]: [POS, POS],\n    [HoverButtonPosition.bottomRightSW]: [POS, MAX],\n\n    [HoverButtonPosition.topRightSE]: [MAX, NEG],\n    [HoverButtonPosition.eastEast]: [MAX, CENTER],\n    [HoverButtonPosition.bottomRightNE]: [MAX, POS]\n};\n\ninterface Offset {\n    x: number;\n    y: number;\n}\n\nexport function topLeftOf(element: Element): Offset {\n    const {left, top} = element.getBoundingClientRect();\n    return {x: left, y: top};\n}\n\nexport function relativeTo(area: Area, position: HoverButtonPosition, buttonSize: number): Offset {\n    const distances = RELATIVE_DISTANCES[position];\n\n    const x = distances[0](area.width, buttonSize);\n    const y = distances[1](area.height, buttonSize);\n\n    return {x, y};\n}\n\nexport function add(offsetA: Offset, offsetB: Offset): Offset {\n    return {x: offsetA.x + offsetB.x, y: offsetA.y + offsetB.y};\n}\n\nexport function constrainTo(offset: Offset, area: Area): Offset {\n    const x = Math.max(0, Math.min(area.width, offset.x));\n    const y = Math.max(0, Math.min(area.height, offset.y));\n\n    return {x, y};\n}\n","import {HoverButtonPosition} from \"../../common/settings/enums\";\nimport {Settings} from \"../../common/settings/io\";\nimport {startDownload} from \"../downloads\";\nimport {monitor} from \"../../common/settings/monitoring\";\nimport {matching, ofViewport, shrink} from \"./area\";\nimport * as element from \"./element\";\nimport {add, constrainTo, relativeTo, topLeftOf} from \"./offset\";\n\nlet anchor: HTMLImageElement | null = null;\nlet makeup: {\n    position: HoverButtonPosition;\n    size: number;\n} | null = null;\n\nfunction alignToAnchor(): void {\n    if (makeup == null) {\n        throw new Error(\"button is not initialized yet\");\n    }\n    if (anchor == null) {\n        throw new Error(\"cannot align without anchor\");\n    }\n\n    const offsetRelativeToAnchor = relativeTo(matching(anchor), makeup.position, makeup.size);\n    const absoluteOffset = add(offsetRelativeToAnchor, topLeftOf(anchor));\n    const whereButtonIsVisible = shrink(ofViewport(), makeup.size);\n    const {x, y} = constrainTo(absoluteOffset, whereButtonIsVisible);\n\n    element.setCoordinates(x, y);\n}\n\nfunction setSize(settings: Settings): void {\n    if (makeup == null) {\n        throw new Error(\"button is not initialized yet\");\n    }\n\n    makeup.size = settings.buttonSize;\n    element.setSize(makeup.size);\n\n    if (element.isInserted()) {\n        alignToAnchor();\n    }\n}\n\nfunction setPosition(settings: Settings): void {\n    if (makeup == null) {\n        throw new Error(\"button is not initialized yet\");\n    }\n\n    makeup.position = settings.buttonPosition;\n\n    if (element.isInserted()) {\n        alignToAnchor();\n    }\n}\n\nfunction insert(): void {\n    document.addEventListener(\"scroll\", alignToAnchor);\n    element.insert();\n}\n\nexport function updateVisualsOnChanges(): void {\n    monitor(\"buttonSize\", settings => setSize(settings));\n    monitor(\"buttonPosition\", settings => setPosition(settings));\n\n    monitor(\"buttonOpacity\", settings => element.setOpacity(settings));\n    monitor(\"oneClickStyle\", settings => element.setSkin(settings));\n}\n\nexport function remove(): void {\n    if (element.isInserted()) {\n        element.unsert();\n        document.removeEventListener(\"scroll\", alignToAnchor);\n        anchor = null;\n    }\n}\n\nexport function attachTo(image: HTMLImageElement): void {\n    if (!element.isInserted()) {\n        insert();\n    }\n\n    anchor = image;\n    alignToAnchor();\n}\n\nexport function init(settings: Settings): void {\n    makeup = {\n        position: settings.buttonPosition,\n        size: settings.buttonSize\n    };\n\n    element.setSkin(settings);\n    element.setOpacity(settings);\n    setSize(settings);\n    setPosition(settings);\n\n    element.click.subscribe(() => {\n        if (anchor == null) {\n            throw new Error(\"button attached to nothing?\");\n        }\n        startDownload(anchor).catch(console.error);\n    }, \"download hovered image\");\n}\n","import {triggerable} from \"../common/triggerable\";\nimport {isButton} from \"./hoverbutton/element\";\n\nlet lastHoveredElement: Element | null = null;\n\nconst {hide: hoverEvent, expose: hover} = triggerable<MouseEvent>();\n// will not trigger for the hoverbutton's image or the same image redundantly\nexport {hover};\n\nexport function trackHovers(): void {\n    // is also triggered on pageload for element mouse is immediately on, no movement needed\n    document.addEventListener(\"mouseover\", event => {\n        // can't mouse over much else\n        const hovered = event.target as Element;\n\n        if (!isButton(hovered) && hovered !== lastHoveredElement) {\n            lastHoveredElement = hovered;\n            hoverEvent.trigger(event);\n        }\n    });\n}\n\nexport function getLastHoveredElement(): Element | null {\n    return lastHoveredElement;\n}\n","import {Settings} from \"../../common/settings/io\";\nimport {passesShiftKeySetting, passesSizeRestrictions} from \"../../common/settings/settings\";\nimport {filteringAllows} from \"../filtering\";\nimport * as layout from \"./layout\";\nimport {isImage} from \"../dom\";\nimport {hover} from \"../hover-tracking\";\nimport {monitor} from \"../../common/settings/monitoring\";\n\nasync function adaptToHoveredElement(settings: Settings, event: MouseEvent): Promise<void> {\n    // can't mouse over anything else\n    const eventTarget = event.target as Element;\n\n    if (isImage(eventTarget)) {\n        const allowedByAllSettings =\n            passesShiftKeySetting(event, settings) &&\n            passesSizeRestrictions(eventTarget, settings) &&\n            (await filteringAllows(location)) &&\n            (await filteringAllows(eventTarget));\n\n        if (allowedByAllSettings) {\n            layout.attachTo(eventTarget);\n        } else {\n            layout.remove();\n        }\n    } else {\n        if (!settings.persist) {\n            layout.remove();\n        }\n    }\n}\n\nlet listenerToken: symbol | null = null;\n\nfunction actualizeState(settings: Settings): void {\n    if (settings.singleClickEnabled) {\n        if (listenerToken == null) {\n            listenerToken = hover.subscribe(event => void adaptToHoveredElement(settings, event).catch(console.error), \"move button onto hovered image\");\n        }\n    } else {\n        if (listenerToken != null) {\n            hover.unsubscribe(listenerToken);\n            listenerToken = null;\n        }\n\n        // the setting might have changed while the button was displayed\n        layout.remove();\n    }\n}\n\nexport function armHoverButton(settings: Settings): void {\n    layout.init(settings);\n    actualizeState(settings);\n\n    layout.updateVisualsOnChanges();\n    monitor(\"singleClickEnabled\", st => actualizeState(st));\n}\n","import {hotkeyTriggered, TriggeredMessage} from \"../common/messages\";\nimport {getLastPosition} from \"./cursor-tracking\";\nimport {findImageDepthFirst, isImage} from \"./dom\";\nimport {startDownload} from \"./downloads\";\nimport {getLastHoveredElement} from \"./hover-tracking\";\n\nfunction downloadHoverTracked(): boolean {\n    const lastHoveredElement = getLastHoveredElement();\n\n    if (lastHoveredElement != null && isImage(lastHoveredElement)) {\n        startDownload(lastHoveredElement).catch(console.error);\n        return true;\n    } else {\n        return false;\n    }\n}\n\n// this can find images where e.g. `pointer-events: none;` prevents hover tracking from working\nfunction downloadCursorTracked(): boolean {\n    const lastPosition = getLastPosition();\n\n    if (lastPosition == null) {\n        return false;\n    }\n\n    const pointingAt = document.elementsFromPoint(...lastPosition);\n\n    for (const pointed of pointingAt) {\n        const nestedImage = findImageDepthFirst(pointed);\n        if (nestedImage != null) {\n            startDownload(nestedImage).catch(console.error);\n            return true;\n        }\n    }\n\n    return false;\n}\n\nexport function downloadHoveredImage(): TriggeredMessage {\n    return hotkeyTriggered(downloadHoverTracked() || downloadCursorTracked());\n}\n","export function getImagesInSelection(): HTMLImageElement[] {\n    const selection = getSelection();\n\n    if (selection == null) {\n        throw new Error(\"too late to get the selection?\");\n    }\n\n    return Array.from(document.images).filter(link => selection.containsNode(link));\n}\n","import {browser} from \"webextension-polyfill-ts\";\nimport {asMessage, Message, TriggeredMessage} from \"../common/messages\";\nimport {startDownload, completeDownload} from \"./downloads\";\nimport {downloadHoveredImage} from \"./hotkey\";\nimport {getImagesInSelection} from \"./selection\";\n\nasync function reactToMessage(msg: Message): Promise<undefined | TriggeredMessage> {\n    switch (msg.subject) {\n        case \"downloadStarted\":\n            throw new Error(\"download start message should have been handled inline\");\n\n        case \"getImagesInSelection\":\n            await Promise.all(getImagesInSelection().map(startDownload));\n            return;\n\n        case \"downloadFinished\":\n            completeDownload(msg);\n            return;\n\n        case \"downloadRequested\":\n            throw new Error(\"content script should not receive download request\");\n\n        case \"hotkeyTriggered\":\n            return downloadHoveredImage();\n\n        default:\n            throw new Error(`unrecognized message: ${JSON.stringify(msg)}`);\n    }\n}\n\nexport function listenForMessages(): void {\n    browser.runtime.onMessage.addListener(async (data: unknown) => reactToMessage(asMessage(data)).catch(console.error));\n}\n","import {trackCursor} from \"./content/cursor-tracking\";\nimport {monitorClicks} from \"./content/doubleclick\";\nimport {monitorDrags} from \"./content/drag\";\nimport {armHoverButton} from \"./content/hoverbutton/hoverbutton\";\nimport {listenForMessages} from \"./content/messaging\";\nimport {load} from \"./common/settings/settings\";\nimport {monitorStorage} from \"./common/settings/monitoring\";\nimport {trackHovers} from \"./content/hover-tracking\";\n\nload()\n    .then(settings => {\n        monitorClicks(settings);\n        armHoverButton(settings);\n        monitorDrags(settings);\n        trackCursor(settings);\n\n        trackHovers();\n        listenForMessages();\n        monitorStorage();\n    })\n    .catch(console.error);\n"]}